"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const MAIN_URL="https://net20.cc",STREAM_URL="https://net51.cc",USER_TOKEN="233123f803cf02184bf6c67e149cdd50",UA="Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Mobile Safari/537.36";async function getBypassCookie(axios){try{const sc=(await axios.post(`${MAIN_URL}/tv/p.php`,null,{headers:{"User-Agent":UA,"X-Requested-With":"XMLHttpRequest",Referer:`${MAIN_URL}/`,Cookie:`ott=pv; hd=on; user_token=${USER_TOKEN};`}})).headers["set-cookie"];if(sc){const match=(Array.isArray(sc)?sc.join(";"):sc).match(/t_hash_t=[^;]+/);if(match)return match[0]}}catch(_a){}return""}async function getStream({link:link,providerContext:providerContext}){const{axios:axios}=providerContext,unixTime=Math.floor(Date.now()/1e3),[id,title=""]=link.split("|"),tHash=await getBypassCookie(axios);if(!tHash)return[];const playlist=(await axios.get(`${MAIN_URL}/pv/playlist.php?id=${id}&t=${encodeURIComponent(title)}&tm=${unixTime}`,{headers:{"User-Agent":UA,"X-Requested-With":"XMLHttpRequest",Referer:`${MAIN_URL}/home`,Cookie:`${tHash}; ott=pv; hd=on`}})).data,streams=[];if(Array.isArray(playlist))for(const item of playlist)for(const src of item.sources||[]){if(!src.file||!src.file.includes(".m3u8"))continue;const finalUrl=STREAM_URL+src.file.replace("/tv/","/");streams.push({server:`PrimeVideo ${src.label||"Auto"}`,link:finalUrl,type:"m3u8",headers:{"User-Agent":UA,Cookie:"hd=on",Referer:`${STREAM_URL}/`}})}return streams}