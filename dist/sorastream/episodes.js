"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=getEpisodes;const API_KEY="397ab42557b66900076c80feac6020d0",TMDB_API="https://api.themoviedb.org/3";async function getEpisodes({url:url,providerContext:providerContext}){const axios=providerContext.axios;let data;try{data=JSON.parse(url)}catch(_a){throw new Error("Invalid episode payload")}const episodes=[],seasons=(await axios.get(`${TMDB_API}/tv/${data.id}?api_key=${API_KEY}`)).data.seasons||[];return await Promise.all(seasons.map(async season=>{if(0!==season.season_number)try{const seasonRes=await axios.get(`${TMDB_API}/tv/${data.id}/season/${season.season_number}?api_key=${API_KEY}`);for(const ep of seasonRes.data.episodes||[])episodes.push({title:`S${ep.season_number}E${ep.episode_number} - ${ep.name}`,link:JSON.stringify({id:data.id,imdbId:data.imdbId,title:data.title,year:data.year,type:"tv",season:ep.season_number,episode:ep.episode_number})})}catch(e){}})),episodes.sort((a,b)=>{const A=JSON.parse(a.link),B=JSON.parse(b.link);return A.season===B.season?A.episode-B.episode:A.season-B.season})}