"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Cache-Control":"no-store",DNT:"1","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"};async function getStream({link:link,type:type,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio,extractors:extractors}=providerContext,streams=[];try{let res=await axios.get(link,{headers:headers,signal:signal}),$=cheerio.load(res.data);const csrfInput=$("input[type='hidden'][name^='_csrf']").first(),csrfName=csrfInput.attr("name"),csrfValue=csrfInput.attr("value");if(csrfName&&csrfValue){const formData=new URLSearchParams;formData.append(csrfName,csrfValue),res=await axios.post(link,formData.toString(),{headers:{...headers,"Content-Type":"application/x-www-form-urlencoded",Referer:link},signal:signal}),$=cheerio.load(res.data)}const extractedLinks=new Set;$("a[href]").each((_,el)=>{const href=$(el).attr("href");href&&(href.includes("hubcloud.")||href.includes("hubdrive."))&&extractedLinks.add(href)});for(const url of extractedLinks)if(url.includes("hubcloud.")){const hubStreams=await extractors.hubcloudExtracter(url,signal);(null==hubStreams?void 0:hubStreams.length)&&streams.push(...hubStreams)}else streams.push({server:"HubDrive",link:url,type:"file"});if(link.includes("gdflix.dev/file/")){link=link.replace("gdflix.dev","new12.gdflix.net"),res=await axios.get(link,{headers:headers,signal:signal}),$=cheerio.load(res.data);const r2Link=$("a.btn-outline-success").filter((_,el)=>$(el).text().toLowerCase().includes("cloud download")).attr("href");r2Link&&streams.push({server:"Cloud R2",link:r2Link,type:"file"});const pixelHref=$("a[href*='pixeldrain.dev/u/']").attr("href");if(pixelHref){const pixelId=pixelHref.split("/").pop();pixelId&&streams.push({server:"PixelDrain",link:`https://pixeldrain.dev/api/file/${pixelId}`,type:"file"})}}return streams}catch(err){return[]}}