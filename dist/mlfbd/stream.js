"use strict";async function getStream({link:link,type:type,signal:signal,providerContext:providerContext}){try{const{axios:axios,cheerio:cheerio,extractors:extractors}=providerContext,headers={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"},res=await axios.get(link,{headers:headers,signal:signal}),$=cheerio.load(res.data),streams=[],pendingStreams=[];if($("#download .links_table table tr").each((_,el)=>{const anchor=$(el).find("a");if(anchor.length>0){const url=anchor.attr("href"),rowText=$(el).text().toLowerCase();let resolution="720p";rowText.includes("1080p")?resolution="1080p":rowText.includes("480p")?resolution="480p":(rowText.includes("2160p")||rowText.includes("4k"))&&(resolution="4k"),url&&pendingStreams.push((async()=>{var _a,_b,_c;try{const linkRes=await axios.get(url,{headers:headers,maxRedirects:5,validateStatus:status=>status<400}),finalUrl=(null===(_a=linkRes.request)||void 0===_a?void 0:_a.responseURL)||(null===(_c=null===(_b=linkRes.request)||void 0===_b?void 0:_b.res)||void 0===_c?void 0:_c.responseUrl)||linkRes.headers.location||linkRes.config.url||url;if(finalUrl.includes("gdflix")||finalUrl.includes("drivebot"))if(extractors.gdFlixExtracter){const extracted=await extractors.gdFlixExtracter(finalUrl,signal);extracted&&0!==extracted.length||streams.push({server:"ERR: Gdflix empty",link:finalUrl,type:"error"}),extracted.forEach(s=>{s.server=`Mlfbd ${resolution} - ${s.server}`,streams.push(s)})}else streams.push({server:"ERR: No gdFlixExtracter",link:finalUrl,type:"error"});else streams.push({server:"Mlfbd "+resolution,link:finalUrl,type:"mkv"})}catch(e){streams.push({server:`ERR: ${e.message}`,link:url,type:"error"})}})())}}),await Promise.all(pendingStreams),0===streams.length){streams.push({server:"DBG: No streams found",link:"error",type:"error"});const downloadSection=$("#download").length,tableSection=$(".links_table").length;streams.push({server:`DBG: Sel: #dl=${downloadSection} .tbl=${tableSection}`,link:"error",type:"error"})}return streams}catch(err){return console.error("Mlfbd getStream error:",err),[{server:`ERR: TopLevel ${err.message}`,link:"error",type:"error"}]}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;