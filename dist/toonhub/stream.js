"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=async function({link:link,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext,streams=[];try{const epRes=await axios.get(link),$=cheerio.load(epRes.data);let embed=$("section.player iframe").attr("src")||$("iframe").attr("src");if(!embed)return[];embed.startsWith("//")&&(embed="https:"+embed);const embedRes=await axios.get(embed),$$=cheerio.load(embedRes.data);let zephyr=$$(".Video iframe").attr("src")||$$("iframe").attr("src");if(!zephyr)return[];zephyr.startsWith("//")&&(zephyr="https:"+zephyr);const idMatch=zephyr.match(/\/video\/([a-f0-9]+)/i);if(!idMatch)return[];const videoId=idMatch[1],apiUrl=`${zephyr.split("/").slice(0,3).join("/")}/player/index.php?data=${videoId}&do=getVideo`,headers={accept:"*/*","accept-language":"en-US,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest",Referer:zephyr,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"},body=`hash=${videoId}&r=`,apiRes=await axios.post(apiUrl,body,{headers:headers});let m3u8;if("string"==typeof apiRes.data){const match=apiRes.data.match(/https?:\/\/[^\s"'<>]+\.m3u8[^\s"'<>]*/i);m3u8=null==match?void 0:match[0]}else for(const val of Object.values(apiRes.data))if("string"==typeof val&&val.includes(".m3u8")){m3u8=val;break}return m3u8?(streams.push({server:"ToonStream",link:m3u8,type:"m3u8",subtitles:[]}),streams):[]}catch(err){return[]}};exports.getStream=getStream;