"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=async function({link:link,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext,streamLinks=[];try{const res=await axios.get(link,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36",Referer:link}}),$=cheerio.load(res.data);if($('script[type="application/ld+json"]').each((_,el)=>{try{const jsonContent=$(el).html();if(!jsonContent)return;const data=JSON.parse(jsonContent),videoObj=data.video||("VideoObject"===data["@type"]?data:null);if(videoObj){let m3u8Url=videoObj.contentUrl||"";if(!m3u8Url&&videoObj.embedUrl){const match=videoObj.embedUrl.match(/url=(https?:\/\/[^&]+)/);m3u8Url=match?decodeURIComponent(match[1]):videoObj.embedUrl}m3u8Url&&m3u8Url.includes(".m3u8")&&streamLinks.push({server:"Primary",link:m3u8Url,type:"m3u8",subtitles:[]})}}catch(e){}}),0===streamLinks.length){const match=/"(https?:\/\/[^"]+index\.m3u8[^"]*)"/g.exec(res.data);match&&streamLinks.push({server:"Secondary",link:match[1],type:"m3u8",subtitles:[]})}return streamLinks}catch(err){return[]}};exports.getStream=getStream;