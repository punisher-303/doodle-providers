"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8","Cache-Control":"no-store","Accept-Language":"en-US,en;q=0.9",DNT:"1","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"};function getDownloadLinks(watchUrl,movieTitle,providerContext){const{axios:axios,cheerio:cheerio}=providerContext,finalLinks=[];return axios.get(watchUrl,{headers:headers}).then(res1=>{let $=cheerio.load(res1.data);const serverLink=$('li[data-server="3"][data-putload]').attr("data-putload");return serverLink?axios.get(serverLink,{headers:{...headers,Referer:watchUrl}}).then(res2=>{$=cheerio.load(res2.data);const linkGateUrl=$(".content-pt a button").parent().attr("href");return linkGateUrl?axios.get(linkGateUrl,{headers:{...headers,Referer:serverLink}}).then(res3=>{$=cheerio.load(res3.data);const iframeSrc=$(".video-container iframe").attr("src");return iframeSrc?axios.get(iframeSrc,{headers:{...headers,Referer:linkGateUrl}}).then(res4=>{$=cheerio.load(res4.data);const cdnUrl=$(".content-pt a button").parent().attr("href");return cdnUrl?axios.get(cdnUrl,{headers:{...headers,Referer:iframeSrc}}).then(res5=>($=cheerio.load(res5.data),$("button[onclick^='download_video']").each((_,el)=>{const text=$(el).text().trim();finalLinks.push({title:`${movieTitle} - ${text}`,quality:"Download",episodesLink:cdnUrl,directLinks:[{title:text,link:cdnUrl,type:"movie"}]})}),finalLinks)):finalLinks}):finalLinks}):finalLinks}):finalLinks}).catch(()=>finalLinks)}const getMeta=function({link:link,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext,baseUrl=link.split("/").slice(0,3).join("/"),empty={title:"",synopsis:"",image:"",imdbId:"",type:"movie",linkList:[]};return axios.get(link,{headers:{...headers,Referer:baseUrl}}).then(res=>{const $=cheerio.load(res.data),detail=$(".main-detail"),result={title:detail.find(".detail-mod h3").text().trim()||$("title").text().split("|")[0].trim(),synopsis:detail.find(".desc p").text().trim(),image:detail.find(".dm-thumb img").attr("src")||"",imdbId:detail.find("#imdb_id").text().trim(),type:"movie",linkList:[]};result.image.startsWith("//")&&(result.image="https:"+result.image);let finalLinks=[];const watchingUrl=link.endsWith("/")?link+"watching":link+"/watching";finalLinks.push({title:`${result.title} - Watch Now`,quality:"Watch",episodesLink:watchingUrl,directLinks:[{title:"Watch",link:watchingUrl,type:"movie"}]});const iframeSrc=$("#content-embed iframe").attr("src");iframeSrc&&finalLinks.push({title:`${result.title} - Stream`,quality:"Stream",episodesLink:link,directLinks:[{title:"Stream Player",link:iframeSrc,type:"movie"}]});const watchBtn=detail.find(".ch_btn_box a.bwac-btn").attr("href");return watchBtn?getDownloadLinks(watchBtn,result.title,providerContext).then(downloads=>(finalLinks=finalLinks.concat(downloads),detail.find(".mobile-btn a.mod-btn").each((_,el)=>{const title=$(el).text().trim(),href=$(el).attr("href");href&&!title.includes("Android APP")&&finalLinks.push({title:`${result.title} - ${title}`,quality:"External",episodesLink:href,directLinks:[{title:title,link:href,type:"movie"}]})}),result.linkList=finalLinks,result)):(result.linkList=finalLinks,result)}).catch(()=>empty)};exports.getMeta=getMeta;