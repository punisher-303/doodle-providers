"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const baseHeaders={"User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Mobile Safari/537.36",Accept:"*/*","Accept-Language":"en-IN,en-GB;q=0.9,en-US;q=0.8,en;q=0.7"};function decodeHost(html){const match=html.match(/const\s+parts\s*=\s*(\[[^\]]+\])/);if(!match)return null;try{const parts=JSON.parse(match[1]);return Buffer.from(parts.join(""),"base64").toString("utf8").trim().replace(/\/+$/,"")}catch(_a){return null}}async function getStream({link:link,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext;try{const epHtml=(await axios.get(link,{headers:{...baseHeaders,Referer:"https://dramanicee.lat/"},signal:signal})).data,$=cheerio.load(epHtml),embed=$(".servers .server.active").attr("data-embed")||$(".servers .server").first().attr("data-embed");if(!embed)return[];const host=decodeHost(epHtml)||"https://player.5274274.xyz",emReferer=`${host}/em?id=${embed}&sv=v8`;return[{server:"Dramanicee",type:"m3u8",link:`${host}/media/${embed}.m3u8`,headers:{...baseHeaders,Referer:emReferer,"Sec-Fetch-Site":"same-origin","Sec-Fetch-Mode":"cors","Sec-Fetch-Dest":"empty"}}]}catch(err){return[]}}