"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=void 0;const headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Encoding":"gzip, deflate, br, zstd","Accept-Language":"en-IN,en;q=0.9","Cache-Control":"max-age=0",Connection:"keep-alive",Cookie:"_popprepop=1; key=8a93821ca8ad1cb9cd9de1658aa97603",Host:"animeheaven.me",Referer:"https://animeheaven.me/anime.php?mruwf","User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Mobile Safari/537.36"},getEpisodes=({url:url,providerContext:providerContext})=>{const{axios:axios,cheerio:cheerio}=providerContext;return axios.get(url,{headers:headers}).then(res=>{const $=cheerio.load(res.data),episodes=[],aTags=$(".linetitle2 a").toArray();let chain=Promise.resolve();return aTags.forEach(el=>{chain=chain.then(()=>{const aTag=$(el),epiNum=aTag.find(".watch2").text().trim(),onclick=aTag.attr("onclick")||"",onmouseover=aTag.attr("onmouseover")||"",onclickMatch=onclick.match(/gate\(["']([a-f0-9]+)["']\)/i),onmouseoverMatch=onmouseover.match(/gateh\(["']([a-f0-9]+)["']\)/i),gateHash=onclickMatch?onclickMatch[1]:onmouseoverMatch?onmouseoverMatch[1]:null;if(epiNum&&gateHash){const formData=new URLSearchParams;return formData.append("id",gateHash),axios.post("https://animeheaven.me/gate.php",formData.toString(),{headers:Object.assign(Object.assign({},headers),{"Content-Type":"application/x-www-form-urlencoded"})}).then(jsonRes=>{var _a;const realLink=(null===(_a=jsonRes.data)||void 0===_a?void 0:_a.link)||`https://animeheaven.me/gate.php?id=${gateHash}`;episodes.push({title:`Episode ${epiNum}`,link:realLink})}).catch(()=>{})}return Promise.resolve()})}),chain.then(()=>episodes.reverse())}).catch(()=>[])};exports.getEpisodes=getEpisodes;