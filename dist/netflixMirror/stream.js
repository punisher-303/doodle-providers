"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const MAIN_URL="https://net22.cc",STREAM_URL="https://net52.cc",UA="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36";async function getBypassCookie(axios){try{for(let i=0;i<5;i++){const res=await axios.post(`${MAIN_URL}/tv/p.php`,null,{headers:{"User-Agent":UA,"X-Requested-With":"XMLHttpRequest",Referer:`${MAIN_URL}/`,Cookie:"ott=nf; hd=on; user_token=233123f803cf02184bf6c67e149cdd50;"}}),dataStr=JSON.stringify(res.data);if(dataStr&&dataStr.includes('"r":"n"')){const setCookie=res.headers["set-cookie"];if(setCookie){const match=(Array.isArray(setCookie)?setCookie.join(";"):setCookie).match(/t_hash_t=[^;]+/);if(match)return match[0]}}}}catch(_a){}return""}async function getVideoToken(axios,id,cookieHeader){var _a;try{const hParam=null===(_a=(await axios.post(`${MAIN_URL}/play.php`,`id=${id}`,{headers:{"X-Requested-With":"XMLHttpRequest",Referer:`${MAIN_URL}/`,Cookie:cookieHeader,"Content-Type":"application/x-www-form-urlencoded"}})).data)||void 0===_a?void 0:_a.h;if(!hParam)return"";const headers2={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8","Accept-Language":"en-GB,en;q=0.9",Connection:"keep-alive",Host:"net52.cc",Referer:`${MAIN_URL}/`,"User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"},match=(await axios.get(`${STREAM_URL}/play.php?id=${id}&${hParam}`,{headers:headers2})).data.match(/data-h="([^"]+)"/);return match?match[1]:""}catch(e){return""}}async function getStream({link:link,providerContext:providerContext}){const{axios:axios}=providerContext,unixTime=Math.floor(Date.now()/1e3),[id,title=""]=link.split("|"),tHash=await getBypassCookie(axios);if(!tHash)return[];const cookieHeader=`ott=nf; hd=on; user_token=233123f803cf02184bf6c67e149cdd50; ${tHash}`,videoToken=await getVideoToken(axios,id,cookieHeader),playlistUrl=`${STREAM_URL}/playlist.php?id=${id}&t=${encodeURIComponent(title)}&tm=${unixTime}&h=${videoToken}`,streams=[],playlist=(await axios.get(playlistUrl,{headers:{"User-Agent":UA,"X-Requested-With":"XMLHttpRequest",Referer:`${STREAM_URL}/`,Cookie:cookieHeader}})).data;if(Array.isArray(playlist))for(const item of playlist)for(const src of item.sources||[]){if(!src.file||!src.file.includes(".m3u8"))continue;const finalUrl=STREAM_URL+src.file.replace("/tv/","/");streams.push({server:`NetflixMirror ${src.label||"Auto"}`,link:finalUrl,type:"m3u8",headers:{"User-Agent":UA,Accept:"*/*",Cookie:"hd=on",Referer:`${STREAM_URL}/`,Origin:`${STREAM_URL}`}})}return streams}