"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const getMeta=async function({link:link,providerContext:providerContext}){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p;const axios=providerContext.axios;try{const data=(await axios.get(link)).data,meta={title:(null===(_a=null==data?void 0:data.meta)||void 0===_a?void 0:_a.name)||"",synopsis:(null===(_b=null==data?void 0:data.meta)||void 0===_b?void 0:_b.description)||"",image:(null===(_c=null==data?void 0:data.meta)||void 0===_c?void 0:_c.background)||"",imdbId:(null===(_d=null==data?void 0:data.meta)||void 0===_d?void 0:_d.imdb_id)||"",type:(null===(_e=null==data?void 0:data.meta)||void 0===_e?void 0:_e.type)||"movie"},links=[];let directLinks=[],season=new Map;if("series"===meta.type){null===(_g=null===(_f=null==data?void 0:data.meta)||void 0===_f?void 0:_f.videos)||void 0===_g||_g.map(video=>{var _a,_b,_c,_d,_e,_f,_g,_h;(null==video?void 0:video.season)<=0||(season.has(null==video?void 0:video.season)||season.set(null==video?void 0:video.season,[]),season.get(null==video?void 0:video.season).push({title:"Episode "+(null==video?void 0:video.episode),type:"series",link:JSON.stringify({title:null===(_a=null==data?void 0:data.meta)||void 0===_a?void 0:_a.name,imdbId:null===(_b=null==data?void 0:data.meta)||void 0===_b?void 0:_b.imdb_id,season:null===(_c=null==video?void 0:video.id)||void 0===_c?void 0:_c.split(":")[1],episode:null===(_d=null==video?void 0:video.id)||void 0===_d?void 0:_d.split(":")[2],type:null===(_e=null==data?void 0:data.meta)||void 0===_e?void 0:_e.type,tmdbId:(null===(_g=null===(_f=null==data?void 0:data.meta)||void 0===_f?void 0:_f.moviedb_id)||void 0===_g?void 0:_g.toString())||"",year:null===(_h=null==data?void 0:data.meta)||void 0===_h?void 0:_h.year})}))});const keys=Array.from(season.keys());keys.sort(),keys.map(key=>{directLinks=season.get(key),links.push({title:`Season ${key}`,directLinks:directLinks})})}else links.push({title:null===(_h=null==data?void 0:data.meta)||void 0===_h?void 0:_h.name,directLinks:[{title:"Movie",type:"movie",link:JSON.stringify({title:null===(_j=null==data?void 0:data.meta)||void 0===_j?void 0:_j.name,imdbId:null===(_k=null==data?void 0:data.meta)||void 0===_k?void 0:_k.imdb_id,season:"",episode:"",type:null===(_l=null==data?void 0:data.meta)||void 0===_l?void 0:_l.type,tmdbId:(null===(_o=null===(_m=null==data?void 0:data.meta)||void 0===_m?void 0:_m.moviedb_id)||void 0===_o?void 0:_o.toString())||"",year:null===(_p=null==data?void 0:data.meta)||void 0===_p?void 0:_p.year})}]});return{...meta,linkList:links}}catch(err){return{title:"",synopsis:"",image:"",imdbId:"",type:"movie",linkList:[]}}};exports.getMeta=getMeta;