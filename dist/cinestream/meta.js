"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const getMeta=async function({link:link,providerContext:providerContext}){const axios=providerContext.axios;try{const data=(await axios.get(link)).data,metaData=(null==data?void 0:data.meta)||{},meta={title:metaData.name||"",synopsis:metaData.description||"",image:metaData.background||"",imdbId:metaData.imdb_id||"",type:metaData.type||"movie",linkList:[]},seasonMap=new Map;return"series"===meta.type?((metaData.videos||[]).forEach(video=>{if(!(null==video?void 0:video.season)||video.season<=0)return;const seasonNum=Number(video.season),episodeNum=Number(video.episode);seasonMap.has(seasonNum)||seasonMap.set(seasonNum,[]),seasonMap.get(seasonNum).push({title:`Episode ${episodeNum}`,link:JSON.stringify({title:meta.title,imdbId:meta.imdbId,type:"series",season:episodeNum?seasonNum:void 0,episode:episodeNum,tmdbId:metaData.moviedb_id?Number(metaData.moviedb_id):void 0,year:metaData.year?Number(metaData.year):void 0})})}),[...seasonMap.keys()].sort((a,b)=>a-b).forEach(season=>{meta.linkList.push({title:`Season ${season}`,directLinks:seasonMap.get(season)})})):meta.linkList.push({title:meta.title,directLinks:[{title:"Movie",link:JSON.stringify({title:meta.title,imdbId:meta.imdbId,type:"movie",tmdbId:metaData.moviedb_id?Number(metaData.moviedb_id):void 0,year:metaData.year?Number(metaData.year):void 0})}]}),meta}catch(err){return{title:"",synopsis:"",image:"",imdbId:"",type:"movie",linkList:[]}}};exports.getMeta=getMeta;