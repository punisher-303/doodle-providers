"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=getEpisodes;const MAIN_URL="https://net20.cc",API_BASE=`${MAIN_URL}/mobile/hs`,USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36",baseHeaders={"User-Agent":USER_AGENT,"X-Requested-With":"XMLHttpRequest",Cookie:"ott=hs; hd=on;",Referer:`${MAIN_URL}/home`};async function getBypassCookie(axios){try{const urls=[`${API_BASE}/p.php`,`${MAIN_URL}/p.php`];for(const url of urls){const res=await axios.post(url,null,{headers:baseHeaders});if(res.data&&JSON.stringify(res.data).includes('"r":"n"')){const setCookie=res.headers["set-cookie"];if(setCookie){const match=(Array.isArray(setCookie)?setCookie.join(";"):setCookie).match(/t_hash_t=[^;]+/);if(match)return match[0]}}}}catch(e){}return""}async function getEpisodes({url:url,providerContext:providerContext}){const{axios:axios}=providerContext,unixTime=Math.floor(Date.now()/1e3),[seriesId,seasonId,rawTitle,type]=url.split("|"),title=(rawTitle||"").replace(/[^a-zA-Z0-9 ]/g,"");if("movie"===type)return[{title:"Full Movie",link:`${seriesId}|${title}`,image:`https://imgcdn.kim/hs/v/${seriesId}.jpg`}];const episodes=[],bypassCookie=await getBypassCookie(axios),headers={...baseHeaders,Cookie:`${baseHeaders.Cookie} ${bypassCookie||""}`};let page=1,hasNextPage=!0;for(;hasNextPage;){const apiUrl=`${API_BASE}/episodes.php?s=${seasonId}&series=${seriesId}&t=${unixTime}&page=${page}`;try{const data=(await axios.get(apiUrl,{headers:headers})).data;Array.isArray(null==data?void 0:data.episodes)&&data.episodes.forEach(ep=>{if(!(null==ep?void 0:ep.id))return;const epNum=ep.ep?ep.ep.replace(/[^\d]/g,""):"",epName=ep.t||`Episode ${epNum}`;episodes.push({title:`E${epNum} - ${epName}`,link:`${ep.id}|${title}`,image:`https://imgcdn.kim/hsepimg/150/${ep.id}.jpg`})}),0!==(null==data?void 0:data.nextPageShow)&&(null==data?void 0:data.episodes)&&0!==data.episodes.length?page++:hasNextPage=!1}catch(e){hasNextPage=!1}}return episodes}