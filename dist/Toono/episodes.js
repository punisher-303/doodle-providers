"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getEpisodes=void 0;const getEpisodes=function({url:url,providerContext:providerContext}){const{axios:axios,cheerio:cheerio,commonHeaders:commonHeaders}=providerContext;return axios.get(url,{headers:commonHeaders}).then(res=>{const $=cheerio.load(res.data),episodePages=[];if($("#episode_by_temp li").each((_,el)=>{const card=$(el),title=card.find("h2.entry-title").text().trim()||card.find(".num-epi").text().trim();let page=card.find("a.lnk-blk").attr("href")||"";page&&(page.startsWith("//")&&(page="https:"+page),episodePages.push({title:title,page:page}))}),0===episodePages.length)return resolveEpisodeStream(url,axios,cheerio,commonHeaders,"Play").then(r=>r?[r]:[]);const tasks=episodePages.map(ep=>resolveEpisodeStream(ep.page,axios,cheerio,commonHeaders,ep.title));return Promise.all(tasks).then(all=>all.filter(Boolean))}).catch(err=>[])};function resolveEpisodeStream(episodePage,axios,cheerio,headers,title){return axios.get(episodePage,{headers:headers}).then(res=>{const $=cheerio.load(res.data);let embed=$("section.player iframe").first().attr("src")||$("iframe").first().attr("src")||"";return embed?(embed.startsWith("//")&&(embed="https:"+embed),axios.get(embed,{headers:headers}).then(embedRes=>{let stream=cheerio.load(embedRes.data)(".Video iframe").attr("src")||"";return stream?(stream.startsWith("//")&&(stream="https:"+stream),{title:title,link:stream}):null})):null}).catch(()=>null)}exports.getEpisodes=getEpisodes;