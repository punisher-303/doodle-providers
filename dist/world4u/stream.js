"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=async function({link:url,type:type,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext,headers={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",Referer:url};try{let fastiUrl="";{const res=await axios.get(url,{headers:headers}),$=cheerio.load(res.data);if(fastiUrl=$("a").filter((_,el)=>$(el).text().toLowerCase().includes("g-drive")).attr("href")||"",!fastiUrl)return[]}let gdflixUrl="";{const res=await axios.get(fastiUrl,{headers:headers}),$=cheerio.load(res.data),csrfName=$('input[name^="_csrf_token"]').attr("name"),csrfVal=$('input[name^="_csrf_token"]').attr("value");if(!csrfName||!csrfVal)return[];const form=new URLSearchParams;form.append(csrfName,csrfVal);const unlockRes=await axios.post(fastiUrl,form,{headers:{...headers,"Content-Type":"application/x-www-form-urlencoded"}});if(gdflixUrl=cheerio.load(unlockRes.data)("a[href*='gdflix']").attr("href")||"",!gdflixUrl)return[]}const streams=[];{const res=await axios.get(gdflixUrl,{headers:headers}),$=cheerio.load(res.data),cloud=$("a:contains('CLOUD')").attr("href")||"";(null==cloud?void 0:cloud.startsWith("http"))&&streams.push({server:"GDFLIX-CLOUD",link:cloud,type:"mkv"});const pixel=$("a[href*='pixeldrain']").attr("href")||"";if(pixel){const id=pixel.split("/").pop();id&&streams.push({server:"PixelDrain",link:`https://pixeldrain.dev/api/file/${id}`,type:"mkv"})}}return streams}catch(err){return[]}};exports.getStream=getStream;