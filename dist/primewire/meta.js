"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeta=void 0;const getMeta=function(_a){return __awaiter(this,arguments,void 0,function*({link:link,providerContext:providerContext}){var _b;try{const{axios:axios,cheerio:cheerio}=providerContext,url=link,baseUrl=link.split("/").slice(0,3).join("/"),html=(yield axios.get(url,{headers:providerContext.commonHeaders})).data,$=cheerio.load(html),imdbId=(null===(_b=$(".movie_info").find('a[href*="imdb.com/title/tt"]:not([href*="imdb.com/title/tt/"])').attr("href"))||void 0===_b?void 0:_b.split("/")[4])||"",title=$(".movie_title, h1.entry-title").first().text().trim()||$("meta[property='og:title']").attr("content")||"",synopsis=$(".movie_synopsis p, .entry-content p, .movie-summary-content p").first().text().trim()||$("meta[name='description']").attr("content")||"",image=$(".movie_thumb img, .poster img, .featured img").attr("src")||$("meta[property='og:image']").attr("content")||"",linkList=[],type=$(".show_season").length>0?"series":"movie";if("series"===type)$(".show_season").each((i,element)=>{const seasonTitle="Season "+$(element).attr("data-id"),episodes=[];$(element).children().each((i,element2)=>{var _a;const $el=$(element2),episodeTitle=$el.text().trim(),episodeLink=$el.find("a").attr("href"),episodeNumber=null===(_a=episodeTitle.match(/E(\d+)/i))||void 0===_a?void 0:_a[1];episodeTitle&&episodeLink&&episodes.push({title:`Episode ${episodeNumber||i+1} - ${episodeTitle}`,link:baseUrl+episodeLink,type:"episode"})}),linkList.push({title:seasonTitle,directLinks:episodes})});else{const movieLinks=[];$(".download-links a, .download a, .entry-content a, a.btn").each((i,el)=>{const $el=$(el),href=$el.attr("href"),linkTitle=$el.text().trim()||"Download Link";href&&"#"!==href&&movieLinks.push({title:linkTitle,link:baseUrl+href,type:"movie"})}),movieLinks.length>0&&linkList.push({title:"Movie Links",directLinks:movieLinks})}return{title:title||"",image:image||"",imdbId:imdbId,synopsis:synopsis||"",type:type,linkList:linkList}}catch(error){return{title:"",image:"",imdbId:"",synopsis:"",linkList:[],type:"movie"}}})};exports.getMeta=getMeta;
