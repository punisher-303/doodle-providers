"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPosts=getPosts,exports.getSearchPosts=getSearchPosts;const defaultHeaders={Referer:"https://dramanicee.lat","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"};async function getPosts({page:page=1,signal:signal,providerContext:providerContext}){return fetchPosts({page:page,providerContext:providerContext,signal:signal})}async function getSearchPosts({searchQuery:searchQuery,page:page=1,signal:signal,providerContext:providerContext}){return fetchPosts({query:searchQuery,page:page,providerContext:providerContext,signal:signal})}async function fetchPosts({query:query,page:page=1,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio,getBaseUrl:getBaseUrl}=providerContext,baseUrl=await getBaseUrl("asianctv");let url=query&&query.trim()?`${baseUrl}/search?keyword=${encodeURIComponent(query.trim())}${page>1?`&page=${page}`:""}`:page>1?`${baseUrl}/recently-added/page/${page}`:`${baseUrl}/recently-added/`;try{const res=await axios.get(url,{headers:defaultHeaders,signal:signal}),$=cheerio.load(res.data||""),posts=[],seen=new Set;return $("ul.items > li").each((_,el)=>{const element=$(el),rawLink=element.find(".img a").attr("href");if(!rawLink)return;const slug=rawLink.replace(/^\/|\/$/g,"").replace(/-episode-\d+$/i,""),link=`${baseUrl}/drama/${slug}/`,title=element.find(".name a").text().trim().replace(/Episode\s*\d+/i,"").trim(),rawImg=element.find(".img img").attr("src"),image=rawImg?rawImg.startsWith("http")?rawImg:baseUrl+rawImg:"";title&&link&&image&&!seen.has(link)&&(posts.push({title:title,link:link,image:image}),seen.add(link))}),posts}catch(err){return[]}}