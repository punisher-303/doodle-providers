<<<<<<< HEAD
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const getStream=async function({link:url,providerContext:providerContext}){const{axios:axios}=providerContext,streamLinks=[],dataMatch=url.match(/\/video\/([a-fA-F0-9]+)/),dataId=dataMatch?dataMatch[1]:null;if(!dataId)return[];const apiUrl=`${url.split("/").slice(0,3).join("/")}/player/index.php?data=${dataId}&do=getVideo`,headers={accept:"*/*","accept-language":"en-US,en;q=0.9,en-IN;q=0.8","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded; charset=UTF-8",pragma:"no-cache","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest",Referer:url,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36",cookie:"fireplayer_player=tlare70v164jv3taph4r8v4qer; ext_name=ojplmecpdpgccookcobabopnaifgidhf"},postBody=`hash=${dataId}&r=`;try{const responseData=(await axios.post(apiUrl,postBody,{headers:headers})).data;let streamUrl;if("string"==typeof responseData){const urlMatch=responseData.match(/https?:\/\/[^\s"]+\.m3u8[^\s"]*/);streamUrl=urlMatch?urlMatch[0]:void 0}else if("object"==typeof responseData&&null!==responseData){const keysToCheck=["source","file"];for(const key of keysToCheck)if("string"==typeof responseData[key]&&responseData[key].includes(".m3u8")){streamUrl=responseData[key];break}if(!streamUrl){const values=Object.values(responseData);for(const value of values)if("string"==typeof value&&value.includes(".m3u8")){streamUrl=value;break}}}return streamUrl&&streamLinks.push({server:"toon",link:streamUrl,type:"m3u8",subtitles:[]}),streamLinks}catch(err){return[]}};exports.getStream=getStream;
=======
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;var headers={Referer:"https://google.com","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"};const PROXY_BASE="http://localhost:3000/proxy?url=";function getStream(options){var link=options.link,providerContext=options.providerContext,signal=options.signal,directLinks=[],seen=new Set,axios=providerContext.axios,cheerio=providerContext.cheerio;return new Promise(function(resolve,reject){axios.get(link,{headers:headers,signal:signal}).then(function(res){var $=cheerio.load(res.data);if($("iframe").each(function(_,el){var src=$(el).attr("src");src&&!seen.has(src)&&(/^http/.test(src)||(src=new URL(src,link).href),seen.add(src),directLinks.push({server:"RareAnimes Iframe",link:PROXY_BASE+encodeURIComponent(src),type:"episode",quality:"auto",headers:headers}))}),$("a").each(function(_,el){var href=$(el).attr("href"),text=$(el).text().trim();href&&!seen.has(href)&&(/^http/.test(href)||(href=new URL(href,link).href),(/\.(mp4|m3u8)$/i.test(href)||/(480|720|1080|2160|4K)p?/i.test(text))&&(seen.add(href),directLinks.push({server:"RareAnimes Static",link:PROXY_BASE+encodeURIComponent(href),type:"episode",headers:headers})))}),!directLinks.length)return reject(new Error("No streams available"));resolve(directLinks)}).catch(function(err){resolve([])})})}
>>>>>>> 7f000b622e14a4045c1d1bf3af4fa78965b8b3b3
