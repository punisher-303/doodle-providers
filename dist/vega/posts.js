"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSearchPosts=exports.getPosts=void 0;const baseUrl="https://vegamovies.menu",CLOUDFLARE_COOKIE="_ga=GA1.1.310039012.1758436198; xla=s4t; prefetchAd_9600333=true; _ga_BLZGKYN5PF=GS2.1.s1761848188$o9$g1$t1761848242$j6$l0$h0; cf_clearance=Y.gf.B8QYkK_4RQbgIu05JhJvo6hb1KD3P95pINxXOk-1761848264-1.2.1.1-5w4ITbFueT5ijnNgOjm_h4E90CPL7XGEvZn9imbshniq7n9.G.tymIXvGgm5bmStGKHKUhtIfYR_7ZEngXH3NvrHFOJh__2IY6_4l4Dcmew4zxWS3WUmIcdui6tEOaoG1cK3iNY558pMBu5_Hu4q._m8zTVRO8sxC0jJgVzj7ef.vM0sys46L.ncIDilpmoV8R3bjI143scCWHMT0EgEzxLsgffZrDisWbdqD_pv3l0",defaultHeaders={"User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Mobile Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","Accept-Language":"en-IN,en-GB;q=0.9,en-US;q=0.8,en;q=0.7,hi;q=0.6,ar;q=0.5,pt;q=0.4","Cache-Control":"max-age=0","Upgrade-Insecure-Requests":"1","Content-Type":"application/x-www-form-urlencoded",Referer:"https://vegamovies.menu/",Cookie:CLOUDFLARE_COOKIE,"sec-ch-ua":'"Google Chrome";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?1","sec-ch-ua-platform":'"Android"',"Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"same-origin","Sec-Fetch-User":"?1"};function buildFormData(data){return Object.keys(data).map(key=>encodeURIComponent(key)+"="+encodeURIComponent(data[key])).join("&")}const getPosts=({filter:filter,page:page,providerValue:providerValue,signal:signal,providerContext:providerContext})=>{const{axios:axios,cheerio:cheerio}=providerContext,akroFilter="akro"===(null==providerValue?void 0:providerValue.toLowerCase())?"/akro":"";return posts(baseUrl,`${baseUrl}/${filter}${akroFilter}${page>1?`/page/${page}`:""}/`,signal,defaultHeaders,axios,cheerio)};exports.getPosts=getPosts;const getSearchPosts=({searchQuery:searchQuery,page:page,providerValue:providerValue,signal:signal,providerContext:providerContext})=>{if(!searchQuery||!searchQuery.trim())return Promise.resolve([]);const{axios:axios,cheerio:cheerio}=providerContext,cleanedQuery=searchQuery.trim().replace(/\s+/g,"+"),akroFilter="akro"===(null==providerValue?void 0:providerValue.toLowerCase())?"&akro=true":"",url=`${baseUrl}/?s=${cleanedQuery}${akroFilter}${page>1?`&page=${page}`:""}`,postBody=buildFormData({s:cleanedQuery}),searchReferer=`${baseUrl}/?s=${cleanedQuery}`,searchHeaders=Object.assign(Object.assign({},defaultHeaders),{Referer:searchReferer});return posts(baseUrl,url,signal,searchHeaders,axios,cheerio,"POST",postBody)};function posts(baseUrl,url,signal,headers={},axios,cheerio,method="GET",data){let requestPromise;const requestHeaders=headers;return requestPromise="POST"===method&&data?axios.post(url,data,{headers:requestHeaders,signal:signal}):axios.get(url,{headers:requestHeaders,signal:signal}),requestPromise.then(res=>{var _a,_b;const html=res.data,$=cheerio.load(html),posts=[],seen=new Set;return null===(_b=null===(_a=$(".blog-items,.post-list, .blog-items-wrap"))||void 0===_a?void 0:_a.children("article"))||void 0===_b||_b.each((_,element)=>{var _a,_b,_c,_d,_e,_f,_g;const el=$(element),link=el.find("a[href]").first().attr("href")||"";if(!link||seen.has(link))return;seen.add(link);let title=((null===(_e=null===(_d=null===(_c=null===(_b=null===(_a=null==el?void 0:el.find("a"))||void 0===_a?void 0:_a.attr("title"))||void 0===_b?void 0:_b.replace("Download",""))||void 0===_c?void 0:_c.replace(/\[.*?\]/g,""))||void 0===_d?void 0:_d.replace(/\s{2,}/g," "))||void 0===_e?void 0:_e.trim())||(null===(_f=null==el?void 0:el.find(".post-title").text())||void 0===_f?void 0:_f.replace("Download",""))||(null===(_g=null==el?void 0:el.find("h2 a").text())||void 0===_g?void 0:_g.replace("Download",""))||"").trim();if(title=title.replace(/\[.*?\]/g,"").replace(/\s{2,}/g," ").trim(),!title)return;let image=el.find("a").find("img").attr("data-lazy-src")||el.find("a").find("img").attr("data-src")||el.find("a").find("img").attr("src")||"";image.startsWith("//")&&(image="https:"+image),posts.push({title:title,link:link,image:image})}),posts}).catch(error=>[])}exports.getSearchPosts=getSearchPosts;