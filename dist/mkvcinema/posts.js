"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getPosts=getPosts,exports.getSearchPosts=getSearchPosts;const CLOUDFLARE_COOKIE="cf_clearance=kTmJF5MowuRNdP9v1e1cFUY2T40MTFv73piDuZpcpzw-1761918068-1.2.1.1-dwKcCy0g_eIs7Hfc5cQ7gpoqmXd3v2DoJGwAj4cMgB2NWL85SN715yntOWWWbzksgjUZu9jmaKwfC_PTf3LAfqS3JifxzPZizM0hBVWUAh.SYYfTOf4LgZsu5do9ZJnNLxFA41cQuXvo9CQZEp6pMEzz9CHsNHI8DhRS3UtLNm0zJc25CBjho_SJwsQNsZQAW8zM7vThmlK6DPOb4Xh9w9PLIPuiG2dDtyKlpU4XWTw",baseUrl="https://mkvcinemas.net.in";function wrapWithProxy(customUrl){return"https://api.allorigins.win/raw?url="+encodeURIComponent(customUrl)}const defaultHeaders={"User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Mobile Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8","Accept-Language":"en-IN,en-GB;q=0.9,en-US;q=0.8,en;q=0.7,hi;q=0.6,ar;q=0.5,pt;q=0.4","Cache-Control":"max-age=0","Upgrade-Insecure-Requests":"1",Referer:`${baseUrl}/`,Cookie:CLOUDFLARE_COOKIE,"x-cors-api-key":"cors"};async function getPosts({filter:filter,page:page=1,signal:signal,providerContext:providerContext}){const customUrl=filter?`${baseUrl}/${filter.replace(/^\//,"")}${page>1?`/page/${page}`:""}`:`${baseUrl}${page>1?`/page/${page}`:""}`;return await fetchPosts({customUrl:customUrl,signal:signal,providerContext:providerContext})}async function getSearchPosts({searchQuery:searchQuery,page:page=1,signal:signal,providerContext:providerContext}){if(!(null==searchQuery?void 0:searchQuery.trim()))return[];const cleanedQuery=encodeURIComponent(searchQuery.trim()),searchUrl=`${baseUrl}/?s=${cleanedQuery}${page>1?`&paged=${page}`:""}`;return await fetchPosts({customUrl:searchUrl,signal:signal,providerContext:providerContext})}async function fetchPosts({customUrl:customUrl,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio}=providerContext;try{const html=(await axios.get(wrapWithProxy(customUrl),{headers:defaultHeaders,signal:signal})).data||"",$=cheerio.load(html),posts=[],seen=new Set,POST_SELECTORS=[".pstr_box","article.post",".result-item",".post-item",".movie-item",".item",".thumbnail",".latest-movies",".blog-item",".hentry"].join(",");return $(POST_SELECTORS).each((_,el)=>{var _a;const card=$(el);let link=card.find("a[href]").first().attr("href")||"";if(!link)return;if(link.startsWith("http")||(link=new URL(link,baseUrl).href),seen.has(link))return;let title=card.find("h2 a").text().trim()||card.find("h3 a").text().trim()||card.find("h2").text().trim()||card.find("h3").text().trim()||(null===(_a=card.find("a[title]").attr("title"))||void 0===_a?void 0:_a.trim())||"";title=title.replace(/\[.*?\]|\(.*?\)|Download|WEB[-\s]?DL|BluRay|HDRip/gi,"").replace(/\s{2,}/g," ").trim();const img=card.find("img").attr("data-src")||card.find("img").attr("data-original")||card.find("img").attr("src")||"",image=img?new URL(img,baseUrl).href:"";seen.add(link),title&&link&&posts.push({title:title,link:link,image:image})}),posts.slice(0,100)}catch(err){return[]}}
