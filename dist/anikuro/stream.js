"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=void 0;const API_BASE="https://9aniwatch.tailcf24b9.ts.net/url",SERVERS=["alpha","bravo","delta"],TYPES=["sub","dub"],getStream=async function({link:link,providerContext:providerContext}){var _a,_b;const{axios:axios}=providerContext,streams=[];try{const epMatch=link.match(/[?&]ep=(\d+)/),episodeId=null==epMatch?void 0:epMatch[1];if(!episodeId)return[];for(const type of TYPES)for(const server of SERVERS)try{const apiUrl=`${API_BASE}?server=${server}&type=${type}&episodeId=${episodeId}`,res=await axios.get(apiUrl),data=null==res?void 0:res.data;if(!data)continue;let streamUrl="";if(Array.isArray(data.sources)?streamUrl=null===(_a=data.sources[0])||void 0===_a?void 0:_a.file:(null===(_b=data.sources)||void 0===_b?void 0:_b.file)&&(streamUrl=data.sources.file),!streamUrl)continue;const subtitles=[];if("sub"===type&&Array.isArray(data.tracks))for(const track of data.tracks)track.file&&subtitles.push({title:track.label||"English",language:"en",type:"text/vtt",uri:track.file});streams.push({server:`${server.toUpperCase()}-${type.toUpperCase()}`,link:streamUrl,type:"m3u8"})}catch(_c){}return streams}catch(err){return[]}};exports.getStream=getStream;