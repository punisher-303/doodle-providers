"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStream=getStream;const headers={Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Cache-Control":"no-store","Upgrade-Insecure-Requests":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"};async function getStream({link:link,type:type,signal:signal,providerContext:providerContext}){const{axios:axios,cheerio:cheerio,extractors:extractors}=providerContext,{hubcloudExtracter:hubcloudExtracter}=extractors;try{let finalLink=link;if(link.includes("mobilejsr.com/view")){const unlockPage=await axios.get(link,{headers:headers,signal:signal}),form=cheerio.load(unlockPage.data)("form"),action=form.attr("action")||link,csrfInput=form.find('input[type="hidden"]').first(),csrfName=csrfInput.attr("name"),csrfValue=csrfInput.attr("value");if(csrfName&&csrfValue){const payload=new URLSearchParams;payload.append(csrfName,csrfValue);const unlockedRes=await axios.post(action,payload.toString(),{headers:{...headers,"Content-Type":"application/x-www-form-urlencoded",Referer:link},signal:signal}),hubcloud=cheerio.load(unlockedRes.data)('a[href*="hubcloud.foo"]').attr("href");hubcloud&&(finalLink=hubcloud)}}if(!finalLink.includes("hubcloud")){const html=(await axios.get(finalLink,{headers:headers,signal:signal})).data,hubcloud=cheerio.load(html)('a[href*="hubcloud.foo"]').attr("href");hubcloud&&(finalLink=hubcloud)}return finalLink.includes("hubcloud")?await hubcloudExtracter(finalLink,signal):[]}catch(err){return[]}}